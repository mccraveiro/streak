function stop_gauge(){gauge.stop()}function start_gauge(){gauge.css("width",0).animate({width:"100%"},press_time)}function wrong(){return arrows[current].removeClass().addClass("icon-cancel"),$(".lives i:nth-child("+lives+")").removeClass().addClass("icon-circle-empty"),clearTimeout(timer),0===--lives?game_over():(game(),void 0)}function game_over(){right>BEST_SCORE&&(BEST_SCORE=right,$.cookie("best",right+"",{expires:365})),last.html(right),best.html(BEST_SCORE),clearTimeout(timer),panels[0].fadeOut(),panels[1].fadeOut(),$(".lives").fadeOut(),$(".timer").fadeOut(),$("h2").fadeOut(),playing=!1}function evaluate_pan(a){for(var b=0;4>b&&!(a.indexOf(names[b])>=0);b++);evaluate(b+37)}function evaluate(a){if(playing&&!paused&&allowed&&(stop_gauge(),allowed=!1,a-=37,!(0>a||a>3))){if(a!==expected)return wrong();$("#counter").html(++right),clearTimeout(timer),arrows[current].addClass("correct"),game()}}function difficulty(){press_time-=DEFAULTS.ROUND_DECREASE,press_time=Math.max(press_time,DEFAULTS.MINIMUM_VELOCITY)}function rand(){return~~(4*Math.random())}function game(){if(playing&&!paused){difficulty(),allowed=!1;var a=1^current;panels[current].css("z-index",0),panels[a].css("z-index",1),panels[a].removeClass().addClass("preset-"+rounds%DEFAULTS.PRESETS);var b=rand();expected=b,current=a,arrows[current].removeClass().addClass("icon-"+names[b]+"-open");var c=positions[rand()];panels[current].css({left:c.x,top:c.y}),panels[current].animate({left:0,top:0},fall_time,function(){start_gauge(),allowed=!0,clearTimeout(timer),timer=setTimeout(wrong,press_time)}),rounds++}}var panels=[null,null],arrows=[null,null],gauge=null,last=null,points=null,msg=null,names=["left","up","right","down"],positions=[{x:"100%",y:"0"},{x:"0",y:"100%"},{x:"-100%",y:"0"},{x:"0",y:"-100%"}],rounds=0,right=0,lives=3,fall_time=0,press_time=0,DEFAULTS={PRESETS:8,FALL_TIME:700,PRESS_TIME:2e3,ROUND_DECREASE:30,MINIMUM_VELOCITY:600},BEST_SCORE=0,timer=null,paused=!1,playing=!1,allowed=!1,expected=0,current=1;$(document).ready(function(){window.addEventListener("focus",function(){paused=!1,game()}),window.addEventListener("blur",function(){paused=!0,clearTimeout(timer)}),best=$("#best"),msg=$(".msg"),last=$("#last"),gauge=$("#gauge"),panels[0]=$("#panel-0"),panels[1]=$("#panel-1"),arrows[0]=$("#panel-0 i"),arrows[1]=$("#panel-1 i"),W=panels[0].width(),H=panels[0].height(),$("body").keydown(function(a){evaluate(a.keyCode)}),Hammer(document.body,{recognizers:[[Hammer.Swipe,{direction:Hammer.DIRECTION_ALL}]]}).on("swipeleft",function(a){evaluate_pan(a.type)}).on("swipeup",function(a){evaluate_pan(a.type)}).on("swiperight",function(a){evaluate_pan(a.type)}).on("swipedown",function(a){evaluate_pan(a.type)}),void 0===$.cookie("best")&&$.cookie("best","0",{expires:365}),BEST_SCORE=$.cookie("best"),best.html(BEST_SCORE),last.html(0),msg.fadeIn(),$(".txt a").click(function(){$(".lives i").removeClass().addClass("icon-circle"),$("h2").html("0"),$("h2").fadeIn(),$(".lives").fadeIn(),$(".timer").fadeIn(),fall_time=DEFAULTS.FALL_TIME,press_time=DEFAULTS.PRESS_TIME,rounds=0,lives=3,right=0,gauge.css("width",0),panels[0].fadeIn(),panels[1].fadeIn(),panels[0].css({top:"-100%",left:"-100%"}),panels[1].css({top:"-100%",left:"-100%"}),playing=!0,game()})});